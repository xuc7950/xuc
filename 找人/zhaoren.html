<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>我找一个人，他的名字叫做...</title>
    <style media="screen">
      a{
        font-size:0.5em;
        margin-right: 10px;
        text-decoration: none;
        vlink:red;
        alink:yellow;
      }
    </style>
    <script src="students.json"></script>
    <script type="text/javascript">
      function qkong() {
        if (document.getElementById("befind").value.length==0)
            document.getElementById("find").style.color = "black";
      }


      document.onkeydown = function(ev){
        if (ev.keyCode == 13) find();
      }

      function find(){
        document.getElementById('finded').innerHTML= " ";//清空显示结果
        var n=0;  //个数
        var num = zstu.length;
        var index = new Array();
        var befind = document.getElementById('befind').value;
		if (befind == "徐超" || befind == "2017334450090") befind="嘻嘻嘻";
		if (befind == "xuc7950") befind = "徐超";
        var scoreUrl = "http://stu.zstu.edu.cn/webroot/decision/view/report?viewlet=%2Fyiban%2Fstucj.cpt&op=h5&fine_auth_token=&viewlet=%2Fyiban%2Fstucj.cpt&op=h5&__pi__=true&xuehao=";
        var lessonUrl = "http://stu.zstu.edu.cn/webroot/decision/view/report?fine_auth_token=&viewlet=%2Fchaxun%2FS%E6%88%91%E7%9A%84%E8%AF%BE%E8%A1%A8.cpt&op=h5&__pi__=true&username=";
        var examUrl = "http://stu.zstu.edu.cn/webroot/decision/view/report?fine_auth_token=&viewlet=%2Fyiban%2Fkaoshianpai.cpt&op=h5&__pi__=true&username=";
        var dormUrl = "http://stu.zstu.edu.cn/webroot/decision/view/report?fine_auth_token=&viewlet=%2Fyiban%2F卫生分查询.cpt&op=h5&__pi__=true&username=";
        var cardUrl = "http://stu.zstu.edu.cn/webroot/decision/view/report?fine_auth_token=&viewlet=%2Fyiban%2Fyikatongstu.cpt&op=h5&__pi__=true&yb_studentid=";
        var secondUrl = "http://stu.zstu.edu.cn/webroot/decision/view/report?fine_auth_token=&viewlet=%2Fyiban%2FS第二课堂学分.cpt&op=h5&__pi__=true&username=";
        var elelogUrl = "http://stu.zstu.edu.cn/webroot/decision/view/report?fine_auth_token=&viewlet=%2Fyiban%2FS寝室充电查询.cpt&op=h5&__pi__=true&username=";
        var electricUrl = "http://stu.zstu.edu.cn/webroot/decision/view/report?fine_auth_token=&viewlet=%2Fyiban%2FS寝室电费查询.cpt&op=h5&__pi__=true&username=";
        
		//以名字或学号为索引
		for (var i=0; i<num ; i++){
          if (zstu[i].姓名.replace(/\s+/g,"") == befind || zstu[i].学号.replace(/\s+/g,"") == befind ){
            index[n] = i;
            n++;
          }
        }

		
		//以姓为索引
		if (index.length == 0){
			n = 0;
			for (var i=0; i<num ; i++){
				if (befind == zstu[i].姓名.replace(/(^\s*)|(\s*$)/g, "")[0] ){
					index[n] = i;
					n++;
				}
			}
		}
		
		
        document.getElementById('finded').innerHTML += "已找到"+index.length+"条结果.<hr/>"; 
		
		//打印查询结果
        for (var i=0;i<index.length;i++){
//                 var str = "<input type='button' value='成绩' onclick='location.href="+scoreUrl+"' />";

                var score = "<a href='"+scoreUrl+zstu[index[i]].学号+"&xingming="+zstu[index[i]].姓名+"' >成绩</a>";
                var lesson = "<a href='"+lessonUrl+zstu[index[i]].学号+"' >课表</a>";
                var exam = "<a href='"+examUrl+zstu[index[i]].学号+"' >考试安排</a>";
                var dorm = "<a href='"+dormUrl+zstu[index[i]].学号+"' >寝室人员</a>";
                var card = "<a href='"+cardUrl+zstu[index[i]].学号+"' >一卡通</a>";
                var second = "<a href='"+secondUrl+zstu[index[i]].学号+"' >第二课堂学分</a>";
                var elelog = "<a href='"+elelogUrl+zstu[index[i]].学号+"' >充电记录</a>";
                var electric = "<a href='"+electricUrl+zstu[index[i]].学号+"' >电费</a>";
            document.getElementById('finded').innerHTML += score+lesson+exam+dorm+card+second+elelog+electric;
			var xingming = zstu[index[i]].姓名.replace(/(^\s*)|(\s*$)/g, "");
			var banji = zstu[index[i]].班级.replace(/(^\s*)|(\s*$)/g, "");
			var xuehao = zstu[index[i]].学号.replace(/(^\s*)|(\s*$)/g, "");
			var xingbie = zstu[index[i]].性别.replace(/(^\s*)|(\s*$)/g, "");
			var qinshihao = zstu[index[i]].寝室号.replace(/(^\s*)|(\s*$)/g, "");
			var chuanghao = zstu[index[i]].床号.replace(/(^\s*)|(\s*$)/g, "");
			var beizhu = zstu[index[i]].备注.replace(/(^\s*)|(\s*$)/g, "");
			if (xuehao.replace(/(^\s*)|(\s*$)/g, "") == "2017334450090") {xuehao = "";xingming="";banji="";xingbie="";qinshihao="";chuanghao="";beizhu="admin";};
			//document.getElementById('finded').innerHTML += "<li>姓名："+zstu[index[i]].姓名+"</li><br/><li>班级："+zstu[index[i]].班级+"</li><br/><li>学号："+zstu[index[i]].学号+"</li><br/><li>性别："+zstu[index[i]].性别+"</li><br/><li>寝室号："+zstu[index[i]].寝室号+"</li><br/><li>床号："+zstu[index[i]].床号+"</li><br/><li>备注："+zstu[index[i]].备注+"</li><br/><hr>";
			document.getElementById('finded').innerHTML += "<li>姓名："+xingming+"</li><br/><li>班级："+banji+"</li><br/><li>学号："+xuehao+"</li><br/><li>性别："+xingbie+"</li><br/><li>寝室号："+qinshihao+"</li><br/><li>床号："+chuanghao+"</li><br/><li>备注："+beizhu+"</li><br/><hr>";
        }
		
		
        document.getElementById("find").style.color = "red";
      }


    </script>
  </head>
  <body bgcolor="black">
    <div align="center">
      <hr/><hr/><hr/><hr/>
      <marquee scrollamount="25" style="color:red;font-size:1.5em;">欢 &emsp;迎 &emsp;进 &emsp;入 &emsp;本 &emsp;查 &emsp;询 &emsp;系 &emsp;统</marquee>
      <hr/><hr/><hr/><hr/><br/>
      <input type="text" id="befind" onchange="qkong();" style="opacity:0.8;border-radius:10px;width:500px;height:100px;font-size:3em;">
      <input type="button" name="" value="查找" id="find" onclick="find()" style="opacity:0.7;border-radius:10px;width:200px;height:100px;font-size:3em;">
      <p id="finded" style="color:white;font-size:3em;border-radius:10px;"></p>
    </div>
  </body>
</html>
